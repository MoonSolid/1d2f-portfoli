<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.portfoli.dao.ReportDao">
  <resultMap type="Report" id="ReportMap">
    <id column="board_no" property="number"/>
    <result column="reporter_no" property="reporterNumber"/>
    <result column="target_no" property="targetNumber"/>
    <result column="handle_date" property="handleDate"/>
    <result column="handle_content" property="handleContent"/>

    <association property="member" javaType="Member">
      <id column="member_no" property="number"/>
      <result column="id" property="id"/>
    </association>

    <association property="reportCategory" javaType="ReportCategory">
      <id column="report_class_no" property="number"/>
      <result column="report_class" property="category"/>
    </association>

    <association property="reportHandleCategory" javaType="ReportHandleCategory">
      <id column="handle_class_no" property="number"/>
      <result column="handle_class" property="category"/>
    </association>

    <collection property="attachments" ofType="BoardAttachment">
      <id column="attachment_no" property="attachmentNumber"/>
      <result column="file_name" property="fileName"/>
      <result column="file_path" property="filePath"/>
    </collection>
  </resultMap>

  <insert id="insert" parameterType="Report">
  insert into pf_report(board_no, reporter_no, target_no, report_class_no)
  values(#{number}, #{reporterNumber}, #{targetNumber}, #{reportCategory.number})
  </insert>
</mapper>